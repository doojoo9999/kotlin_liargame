# 라이어 게임 개선 개발 프롬프트

## 프로젝트 개요

실시간 채팅 기반 라이어 게임의 개선 작업을 수행합니다. 게임 디자이너 및 UX/UI 디자이너와의 협의 결과를 반영한 체계적인 개선 계획을 구현해야 합니다.

## Claude Sonnet 4를 위한 개발 지침

### 개발 우선순위 체계
- 🔴 **Critical (즉시 구현)**: 게임 안정성 및 핵심 기능
- 🟡 **High (1차 스프린트)**: 사용자 경험 개선  
- 🟢 **Medium (2차 스프린트)**: 고급 기능 및 확장성

### 기술 스택 확인사항
개발 시작 전 반드시 확인할 사항들:
```bash
# 프로젝트 구조 파악
npm run typecheck
npm run lint
npm run build
npm test
```

---

## 🔴 Critical Priority 구현 사항

### 1. 게임 시작 조건 명확화
**구현 요구사항:**
- 최소 인원: 3명 이상일 때만 게임 시작 가능
- 권장 인원: 5-8명 (게임 밸런스 최적화)
- 최대 인원: 15명
- 준비 상태 시스템: 모든 플레이어 "준비" 상태 필수
- 게임 시작 프로세스: 10초 카운트다운 + 취소 옵션
- 방장 권한: 방장 변경 시스템 및 자동 방장 이양
- 인원 부족 시: 명확한 대기 메시지 및 필요 인원 표시
- 실시간 업데이트: 로그아웃/세션 종료 시 즉시 반영

**개발 접근 방법:**
```typescript
// 예상 인터페이스 구조
interface GameStartConditions {
  minPlayers: number;
  maxPlayers: number;
  recommendedPlayers: [number, number];
  allPlayersReady: boolean;
  countdown: number;
  hostPermissions: HostPermission[];
}

interface PlayerReadyState {
  playerId: string;
  isReady: boolean;
  lastActivity: Date;
}
```

### 2. 게임 진행 중 실시간 인원 수 반영
**구현 요구사항:**
- 연결 끊김 대응: 10-30초 유예 시간
- 재접속 시스템: 재접속 대기 중 게임 일시 정지
- 최소 인원 관리: 2명 이하 시 게임 자동 종료
- 라이어 퇴장 처리: 즉시 종료 또는 긴급 투표
- 악의적 이탈 방지: 게임 중 이탈 시에만 확인 창
- 동적 투표 조정: 현재 접속자 수 기반 자동 조정

**기술 구현 포인트:**
- WebSocket 연결 상태 모니터링
- 하트비트 메커니즘 구현
- 연결 복구 로직
- 상태 동기화 메커니즘

### 3. 게임 종료 조건 명확화
**구현 요구사항:**
- 투표 완료 조건: 모든 활성 플레이어 투표 완료 시
- 라이어 제거: 투표 제외 시 즉시 게임 종료
- 타이 브레이커: 동점 상황 해결 (서든데스/방장 결정)
- 결과 표시: 상세 결과 화면 (역할, 투표 결과, 승리 조건)
- 다음 게임: 새 게임 시작 옵션

### 4. 게임 상태 관리 개선
**구현 요구사항:**
- 서버 중심 관리: 서버에서 권위적 상태 관리
- 상태 동기화: 클라이언트-서버 간 검증 및 동기화
- 체크포인트 시스템: 복잡한 상태 복구
- 원자적 전환: 상태 전환의 원자성 보장 (롤백 포함)
- 상태 표시: 현재 상태와 다음 전환 조건 명확 표시

---

## 🟡 High Priority 구현 사항

### 5. 사용자 인터페이스 개선
**구현 요구사항:**
- 실시간 표시: 접속 플레이어 수 및 연결 상태
- 게임 상태 시각화: 진행 단계별 색상 테마 및 진행도
- 상황별 안내: "지금 무엇을 해야 하나요?" 패널
- 투표 현황: 실시간 투표 진행 상황
- 모바일 최적화: 터치 친화적 인터페이스
- 접근성 개선: 키보드 네비게이션, 스크린 리더 지원

### 6. 주제 및 답안 관리
**구현 요구사항:**
- 연속 추가 기능: 모달창 유지하며 여러 항목 추가
- 답안 보안: 답안 내용 숨김, 개수만 표시
- 커뮤니티 콘텐츠: 사용자 제출 시스템 (Admin 승인 필요)
- 사용 통계: 주제별 성공률 및 인기도
- 신고 시스템: 부적절한 주제 신고 및 관리

### 7. 세션 코드 관리
**구현 요구사항:**
- 보안 강화: 암호화된 세션 코드 (충돌 방지)
- 공유 기능: 방 내부에서만 URL 공유
- 세션 만료: 2시간 후 자동 만료
- 재접속 지원: 세션 코드로 게임 재접속
- 로비 보안: 로비에서 세션 코드 노출 방지

### 8. 플레이어 경험 및 참여도 개선
**구현 요구사항:**
- 신규 사용자 온보딩: 인터랙티브 튜토리얼
- 도움말 시스템: 게임 중 규칙 및 팁 확인
- 역할별 가이드: 라이어/일반 플레이어 맞춤 안내
- 관전 모드: 대기자를 위한 관전 기능

---

## 🟢 Medium Priority 구현 사항

### 9. 그리핑 방지 및 공정성 확보
- 신고 시스템: 플레이어 신고 및 킥 투표
- 행동 추적: 이탈률, 독성 행동 패턴 분석
- 페널티 시스템: 점진적 처벌 시스템
- 공정한 역할 배정: 라이어 순환 시스템
- 채팅 필터: 욕설 및 부적절한 언어 감지

### 10. 접근성 및 사용성 강화
- 키보드 지원: 전체 기능 키보드 조작

### 11. 고급 게임 기능
- 통계 및 성과: 개인 전적, 승률, 역할별 성과
- 도전과제 시스템: 업적 달성 및 보상

---

## 개발 수행 지침

### 시작 전 체크리스트
1. **코드베이스 파악**
   ```bash
   # 프로젝트 구조 확인
   find src -type f -name "*.tsx" -o -name "*.ts" | head -20
   
   # 주요 컴포넌트 파악
   grep -r "GamePage\|PlayerCard\|GameTimer" src/
   
   # 현재 게임 상태 관리 방식 확인
   grep -r "useState\|useContext\|Redux" src/
   ```

2. **현재 구현 상태 분석**
   - 기존 게임 로직 파악
   - WebSocket 구현 여부 확인
   - 상태 관리 패턴 분석
   - UI 컴포넌트 구조 파악

3. **기술 스택 확인**
   - React 버전 및 훅 사용 패턴
   - WebSocket 라이브러리 (Socket.IO 등)
   - 상태 관리 라이브러리
   - UI 라이브러리 (Mantine 등)

### 구현 순서
1. **Critical Priority부터 순차 구현**
2. **각 기능별 단위 테스트 작성**
3. **통합 테스트 및 E2E 테스트**
4. **성능 최적화 및 보안 검토**

### 개발 시 준수사항
- 기존 코드 스타일 및 컨벤션 유지
- TypeScript 타입 안정성 보장
- 접근성 표준 준수
- 모바일 친화적 반응형 디자인
- 보안 모범 사례 적용

### 테스트 요구사항
```bash
# 각 단계별 필수 테스트
npm run typecheck  # 타입 검사
npm run lint       # 코드 품질 검사
npm run test       # 단위 테스트
npm run build      # 빌드 성공 확인
```

### 완료 기준
- [ ] 모든 Critical Priority 기능 구현 완료
- [ ] High Priority 기능 70% 이상 구현
- [ ] 테스트 커버리지 80% 이상 달성
- [ ] 타입 에러 0개
- [ ] 린트 에러 0개
- [ ] 빌드 성공
- [ ] 실제 멀티플레이어 테스트 통과

### 보고서 형식
구현 완료 후 다음 정보 제공:
- 구현된 기능 목록 및 세부사항
- 사용된 기술 및 라이브러리
- 주요 설계 결정 및 근거
- 테스트 결과 및 커버리지
- 알려진 제한사항 및 향후 개선점
- 배포 및 운영 시 고려사항